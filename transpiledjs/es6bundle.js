!function(t){var e={};function n(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(s,o,function(e){return t[e]}.bind(null,o));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);class s{constructor(t=[""],e=[[""]]){this._header,this._rows,this._testResultHeader=[],this._testResultRows=[],this.settings={markedColumns:void 0},this.setHeaderCollection(t),this.setRowsCollection(e)}setHeaderCollection(t){this._header=t}setRowsCollection(t){this._rows=t}getHeaderCollection(){if(this._header)return this._header.slice(0)}getRowsCollection(){if(this._rows)return this._rows.slice(0)}_getTestResultHeader(){if(this._testResultHeader)return this._testResultHeader.slice(0)}_getTestResultRows(){if(this._testResultRows)return this._testResultRows.slice(0)}countRows(){return this._rows?this._rows.length:0}exportMarkedColumns(){if(!this.settings.markedColumns||!this._header||!this._rows)return;if(this.settings.markedColumns.reduce((t,e)=>e>t?e:t,0)>this._header.length)return;const t=this._getHeaderExportVersion(),e=this._getRowsExportVersion();return new s(t,e)}clear(){this._header=[""],this._rows=[[""]],this._testResultHeader=[],this._testResultRows=[]}markColumnsForExportation(t){this.settings.markedColumns=t}appendTestResultColumns(t){const e=[...t];this._testResultHeader=e;let n=e.map(t=>"");this._testResultRows=Array(this.countRows()).fill([]),this._testResultRows=this._testResultRows.map(t=>[...n])}addTestResult({resultColumnIdentifier:t,result:e,itemIndex:n}){if(void 0===n)return;const s=this._getTestResultHeader().indexOf(t);this._testResultRows[n][s]=e}fetchTestResult({resultColumnIdentifier:t,itemIndex:e}){if(void 0===e)return;const n=this._getTestResultHeader().indexOf(t);return this._testResultRows[e][n]}_getHeaderExportVersion(){let t=[];const e=this.getHeaderCollection(),n=this.settings.markedColumns;if(!e||!n)return;n.forEach(n=>{t.push(e[n])});let s=this._getTestResultHeader();return t=[...t,...s],t}_getRowsExportVersion(){const t=this.getRowsCollection(),e=this.settings.markedColumns;if(!t||!e)return;let n,s=[],o=0;return t.forEach(t=>{n=[],e.forEach(e=>{n.push(t[e])});let r=this._getTestResultRows();n=[...n,...r[o++]],s.push(n)}),s}}const o=Object.freeze({STATUS:"Status",EVIDENCE:"EvidÃªncia"}),r=Object.freeze({FAILED:"failed",SUCCESS:"success",ALERT:"alert",PENDING:"pending"});const a=new s;class i{static newTableHeader(t,{displayBadge:e=!1,badgeConfig:{columns:n=[],text:s=""}={}}={}){t||(t=["Empty"]);let o="",r="",a=0;return e&&(r=`<span class="badge badge-pill badge-pale">${s}</span>`),t.forEach(t=>{n.includes(a++)?o+=`<th>${t} ${r}</th>`:o+=`<th>${t}</th>`}),o}static newTableRow(t){t||(t=["Empty"]);let e="";return t.forEach(t=>{e+=`<td>${t}</td>`}),e.split("\n").join("<br>")}static newCheckBox({label:t="",id:e="",value:n="",name:s=""}){const o=[];return o.push('<div class="custom-control custom-checkbox mb-2">'),o.push(`<input type="checkbox" class="custom-control-input" id="${e}" value="${n}" name="${s}">`),o.push(`<label class="custom-control-label" for="${e}">${t}</label>`),o.push("</div>"),o.join("")}}class l{static readTableHeader(t){let e=t.indexOf("||"),n=t.indexOf("||\n",e+2);if(-1===n&&(n=t.lastIndexOf("||")),-1===e||-1===n||e===n)return;return t.substring(e+2,n).split("||").map(t=>t.trim())}static readTableRows(t){const e=[];let n=[],s=0,o=0;for(;;){if(o=t.indexOf("\n|",s),s=t.indexOf("|\n",o),-1===o)break;-1===s&&(s=t.lastIndexOf("|")),n=t.substring(o+2,s).split("|").map(t=>t.trim()),e.push(n)}return 0===e.length?[["No rows"]]:e}static convertFromTableDataSet(t){let e=[],n=t.getHeaderCollection(),s=t.getRowsCollection();if(n&&(e.push("|"),n.forEach(t=>{e.push(`| ${t} |`)}),e.push("|"),s&&e.push("\n")),s){let t=0;s.forEach(n=>{e.push("|"),n.forEach(t=>{e.push(` ${t} |`)}),s[++t]&&e.push("\n")})}return e.join("")}static convertToImageFormat(t,e){return`!${t}.${e}|thumbnail!`}static convertFromImageFormat(t){if(t)return t.substring(1,t.lastIndexOf("."))}static getStatusSymbol(t){switch(t){case r.SUCCESS:return"(/)";case r.FAILED:return"(x)";case r.ALERT:return"(!)";case r.PENDING:default:return"(?)"}}}const u={init(){let t=document.createElement("audio");t.setAttribute("src","https://www.mboxdrive.com/bubble_pop.mp3"),u.sounds.bubbleSound=t,t=document.createElement("audio"),t.setAttribute("src","https://www.mboxdrive.com/glup_effect.mp3"),u.sounds.glubSound=t,t=document.createElement("audio"),t.setAttribute("src","https://www.mboxdrive.com/open_pop.mp3"),u.sounds.poppingSound=t},sounds:{bubbleSound:void 0,glubSound:void 0,poppingSound:void 0},playBubbleSound(){u.sounds.bubbleSound.play()},playGlupSound(){u.sounds.glubSound.play()},playPoppingSound(){u.sounds.poppingSound.play()}};var c=u;let d,p;const m={settings:{currentItem:0,totalItems:0,tableDataSet:a},components:{counter:$("#navigationCounter"),previousButton:$("#btnPrevious"),nextButton:$("#btnNext"),evidenceTextInput:$("#inputFieldResult"),evidenceTypeSelectInput:$("#inputSelectResultType"),statusSelectInput:$("#inputSelectStatus"),statusLabel:$("#statusLabel"),observationTextInput:$("#inputFieldObservation"),resetButton:$("#btnReset"),generateMarkdownButton:$("#btnGenerateTable"),form:$("#formDataNavigator"),fieldSet:$("#fieldSetDataNavigator"),tableTestInfo:$("#tableTestInfo"),headRow:$("#dataHeadRow"),row:$("#dataRow")},init(){this.bindUIActions()},bindUIActions(){d.resetButton.click(()=>{c.playPoppingSound(),d.headRow.html(i.newTableHeader(["Nenhum dado"])),d.row.html(i.newTableRow(["Importe dados de uma tabela markdown"])),this.resetFields(),C.clear(),this.disableDataNavigator(!0)}),d.nextButton.click(()=>{c.playBubbleSound(),h(),p.currentItem=p.currentItem===p.totalItems?1:p.currentItem+1,b()}),d.previousButton.click(()=>{c.playBubbleSound(),h(),p.currentItem=1===p.currentItem?p.totalItems:p.currentItem-1,b()}),d.generateMarkdownButton.click(()=>{c.playGlupSound(),h();const t=a.exportMarkedColumns(),e=l.convertFromTableDataSet(t);C.setTextAreaContent(e)}),d.statusSelectInput.change(()=>{const t=d.statusSelectInput.val();switch(d.statusLabel.removeClass(["bgStatusSuccess","bgStatusAlert","bgStatusFailed"]),t){case r.SUCCESS:return void d.statusLabel.addClass("bgStatusSuccess");case r.ALERT:return void d.statusLabel.addClass("bgStatusAlert");case r.FAILED:return void d.statusLabel.addClass("bgStatusFailed");default:return}})},loadTableDataSet(){p.currentItem=1,p.totalItems=p.tableDataSet.countRows(),function(){const t=p.tableDataSet.getHeaderCollection();d.headRow.html(i.newTableHeader(t,{displayBadge:!0,badgeConfig:{columns:p.tableDataSet.settings.markedColumns,text:"result."}})),b()}(),this.disableDataNavigator(!1)},disableDataNavigator(t){d.fieldSet.prop("disabled",t)},resetFields(){d.form.trigger("reset")}};function h(){let t=d.statusSelectInput.val();t=l.getStatusSymbol(t);const e=function(){const t=[],e=d.evidenceTypeSelectInput.val(),n=d.evidenceTextInput.val().trim(),s=d.observationTextInput.val().trim();n&&(t.push(l.convertToImageFormat(n,e)),s&&t.push("\n"));return t.push(s),t.join("")}();a.addTestResult({resultColumnIdentifier:o.STATUS,result:t,itemIndex:p.currentItem-1}),a.addTestResult({resultColumnIdentifier:o.EVIDENCE,result:e,itemIndex:p.currentItem-1})}function b(){const t=p.tableDataSet.getRowsCollection();d.row.html(i.newTableRow(t[p.currentItem-1]));const{evidenceFilename:e,evidenceObservation:n}=function(){let t,e=a.fetchTestResult({resultColumnIdentifier:o.EVIDENCE,itemIndex:p.currentItem-1}),n="",s=e.indexOf("|thumbnail!");if(r=s,-1!==r){s+=11;const o=e.substring(0,s);n=l.convertFromImageFormat(o),t=e.substring(s).replace("\n","")}else t=e;var r;return{evidenceFilename:n,evidenceObservation:t}}(),s=function(){let t=a.fetchTestResult({resultColumnIdentifier:o.STATUS,itemIndex:p.currentItem-1});return t?function(t){switch(t){case"(/)":return r.SUCCESS;case"(x)":return r.FAILED;case"(!)":return r.ALERT;case"(?)":default:return r.PENDING}}(t):r.PENDING}();d.statusSelectInput.val(s),d.evidenceTextInput.val(e),d.observationTextInput.val(n),d.statusSelectInput.trigger("change"),function(t,e=p.totalItems){d.counter.html(`${t} / ${e}`)}(p.currentItem)}d=m.components,p=m.settings;var g=m;let f;const S={components:{body:$("#importModalBody"),continueButton:$("#btnImportModalContinue"),warningMessage:$("#warningMessageModal"),theModalItself:$("#importModal")},init(){this.bindUIActions()},bindUIActions(){f.continueButton.click((function(){c.playGlupSound();let t=S.getSelectedCheckBoxes();if(0===t.length)return void w("Selecione pelo menos um dos itens");let e=function(t){let e,n=[];return t.each((t,s)=>{e=parseInt(s.getAttribute("value")),n.push(e)}),n}(t);a.markColumnsForExportation(e);const n=a.exportMarkedColumns(),s=l.convertFromTableDataSet(n);C.setTextAreaContent(s),g.loadTableDataSet(),S.toggle()})),f.theModalItself.on("hide.bs.modal",(function(){f.warningMessage.removeClass("show")}))},setImportOptions(t){if(this.clearOptions(),!t)return void w("Nenhum header encontrado");let e,n=0;t.forEach(t=>{var s;e=i.newCheckBox({label:t,id:"option"+n,value:""+n++,name:"import-options-checkbox"}),s=e,f.body.html(f.body.html()+s)})},clearOptions:function(){f.body.html("")},getSelectedCheckBoxes:function(){return $("input[name='import-options-checkbox']:checked")},toggle(){$("#importModal").modal("toggle")}};function w(t){f.warningMessage.html(t),f.warningMessage.addClass("show")}f=S.components;var I=S;let v;const R={components:{textArea:$("#codeEditor"),importButton:$("#btnImport"),copyButton:$("#btnCopy")},init(){v=this.components,this.bindUIActions()},bindUIActions(){v.importButton.click((function(){c.playGlupSound();const t=v.textArea.val();if(!t)return;const e=l.readTableHeader(t),n=l.readTableRows(t);a.clear(),a.setHeaderCollection(e),a.setRowsCollection(n),a.appendTestResultColumns([o.STATUS,o.EVIDENCE]),I.setImportOptions(a.getHeaderCollection()),I.toggle()})),v.copyButton.click((function(){c.playPoppingSound(),v.textArea.select(),document.execCommand("copy")}))},setTextAreaContent(t){v.textArea.val(t)},clear(){this.components.textArea.val("")}};v=R.components;var C=R;window.onload=()=>{c.init(),I.init(),C.init(),g.init(),$('[data-toggle="tooltip"]').tooltip({delay:{show:800}})}}]);