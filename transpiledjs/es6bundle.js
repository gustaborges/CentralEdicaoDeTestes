!function(t){var e={};function n(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(o,s,function(e){return t[e]}.bind(null,s));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);class o{constructor(t=[""],e=[[""]]){this._header,this._rows,this._testResultHeader=[],this._testResultRows=[],this.settings={markedColumns:void 0},this.setHeaderCollection(t),this.setRowsCollection(e)}setHeaderCollection(t){this._header=t}setRowsCollection(t){this._rows=t}getHeaderCollection(){if(this._header)return this._header.slice(0)}getRowsCollection(){if(this._rows)return this._rows.slice(0)}_getTestResultHeader(){if(this._testResultHeader)return this._testResultHeader.slice(0)}_getTestResultRows(){if(this._testResultRows)return this._testResultRows.slice(0)}countRows(){return this._rows?this._rows.length:0}exportMarkedColumns(){if(!this.settings.markedColumns||!this._header||!this._rows)return;if(this.settings.markedColumns.reduce((t,e)=>e>t?e:t,0)>this._header.length)return;const t=this._getHeaderExportVersion(),e=this._getRowsExportVersion();return new o(t,e)}clear(){this._header=[""],this._rows=[[""]],this._testResultHeader=[],this._testResultRows=[]}markColumnsForExportation(t){this.settings.markedColumns=t}appendTestResultColumns(t){const e=[...t];this._testResultHeader=e;let n=e.map(t=>"");this._testResultRows=Array(this.countRows()).fill([]),this._testResultRows=this._testResultRows.map(t=>[...n])}addTestResult({resultColumnIdentifier:t,result:e,itemIndex:n}){if(void 0===n)return;const o=this._getTestResultHeader().indexOf(t);this._testResultRows[n][o]=e}fetchTestResult({resultColumnIdentifier:t,itemIndex:e}){if(void 0===e)return;const n=this._getTestResultHeader().indexOf(t);return this._testResultRows[e][n]}_getHeaderExportVersion(){let t=[];const e=this.getHeaderCollection(),n=this.settings.markedColumns;if(!e||!n)return;n.forEach(n=>{t.push(e[n])});let o=this._getTestResultHeader();return t=[...t,...o],t}_getRowsExportVersion(){const t=this.getRowsCollection(),e=this.settings.markedColumns;if(!t||!e)return;let n,o=[],s=0;return t.forEach(t=>{n=[],e.forEach(e=>{n.push(t[e])});let r=this._getTestResultRows();n=[...n,...r[s++]],o.push(n)}),o}}const s=Object.freeze({STATUS:"Status",EVIDENCE:"EvidÃªncia"}),r=Object.freeze({FAILED:"failed",SUCCESS:"success",ALERT:"alert",PENDING:"pending"});const i=new o;class a{static newTableHeader(t,{displayBadge:e=!1,badgeConfig:{columns:n=[],text:o=""}={}}={}){t||(t=["Empty"]);let s="",r="",i=0;return e&&(r=`<span class="badge badge-pill badge-pale">${o}</span>`),t.forEach(t=>{n.includes(i++)?s+=`<th>${t} ${r}</th>`:s+=`<th>${t}</th>`}),s}static newTableRow(t){t||(t=["Empty"]);let e="";return t.forEach(t=>{e+=`<td>${t}</td>`}),e.split("\n").join("<br>")}static newCheckBox({label:t="",id:e="",value:n="",name:o=""}){const s=[];return s.push('<div class="custom-control custom-checkbox mb-2">'),s.push(`<input type="checkbox" class="custom-control-input" id="${e}" value="${n}" name="${o}">`),s.push(`<label class="custom-control-label" for="${e}">${t}</label>`),s.push("</div>"),s.join("")}}class l{static readTableHeader(t){let e=t.indexOf("||"),n=t.indexOf("||\n",e+2);if(-1===n&&(n=t.lastIndexOf("||")),-1===e||-1===n||e===n)return;return t.substring(e+2,n).split("||").map(t=>t.trim())}static readTableRows(t){const e=[];let n=[],o=0,s=0;for(;;){if(s=t.indexOf("\n|",o),o=t.indexOf("|\n",s),-1===s)break;-1===o&&(o=t.lastIndexOf("|")),n=t.substring(s+2,o).split("|").map(t=>t.trim()),e.push(n)}return 0===e.length?[["No rows"]]:e}static convertFromTableDataSet(t){let e=[],n=t.getHeaderCollection(),o=t.getRowsCollection();if(n&&(e.push("|"),n.forEach(t=>{e.push(`| ${t} |`)}),e.push("|"),o&&e.push("\n")),o){let t=0;o.forEach(n=>{e.push("|"),n.forEach(t=>{e.push(` ${t} |`)}),o[++t]&&e.push("\n")})}return e.join("")}static convertToImageFormat(t,e){return`!${t}.${e}|thumbnail!`}static convertFromImageFormat(t){if(t)return t.substring(1,t.lastIndexOf("."))}static getStatusSymbol(t){switch(t){case r.SUCCESS:return"(/)";case r.FAILED:return"(x)";case r.ALERT:return"(!)";case r.PENDING:default:return"(?)"}}}const u={init(){let t=document.createElement("audio");t.setAttribute("src","https://www.mboxdrive.com/bubble_pop.mp3"),u.sounds.bubbleSound=t,t=document.createElement("audio"),t.setAttribute("src","https://www.mboxdrive.com/glup_effect.mp3"),u.sounds.glubSound=t,t=document.createElement("audio"),t.setAttribute("src","https://www.mboxdrive.com/open_pop.mp3"),u.sounds.poppingSound=t},sounds:{bubbleSound:void 0,glubSound:void 0,poppingSound:void 0},playBubbleSound(){u.sounds.bubbleSound.play()},playGlupSound(){u.sounds.glubSound.play()},playPoppingSound(){u.sounds.poppingSound.play()}};var c=u;let d,p;const m={settings:{currentItem:0,totalItems:0,tableDataSet:i},components:{counter:$("#navigationCounter"),previousButton:$("#btnPrevious"),nextButton:$("#btnNext"),evidenceTextInput:$("#inputFieldResult"),evidenceTypeSelectInput:$("#inputSelectResultType"),statusSelectInput:$("#inputSelectStatus"),observationTextInput:$("#inputFieldObservation"),resetButton:$("#btnReset"),generateMarkdownButton:$("#btnGenerateTable"),form:$("#formDataNavigator"),fieldSet:$("#fieldSetDataNavigator"),tableTestInfo:$("#tableTestInfo"),headRow:$("#dataHeadRow"),row:$("#dataRow")},init(){this.bindUIActions()},bindUIActions(){d.resetButton.click(()=>{c.playPoppingSound(),d.headRow.html(a.newTableHeader(["Nenhum dado"])),d.row.html(a.newTableRow(["Importe dados de uma tabela markdown"])),this.resetFields(),x.clear(),this.disableDataNavigator(!0)}),d.nextButton.click(()=>{c.playBubbleSound(),h(),p.currentItem=p.currentItem===p.totalItems?1:p.currentItem+1,b()}),d.previousButton.click(()=>{c.playBubbleSound(),h(),p.currentItem=1===p.currentItem?p.totalItems:p.currentItem-1,b()}),d.generateMarkdownButton.click(()=>{c.playGlupSound(),h();const t=i.exportMarkedColumns(),e=l.convertFromTableDataSet(t);x.setTextAreaContent(e)})},loadTableDataSet(){p.currentItem=1,p.totalItems=p.tableDataSet.countRows(),function(){const t=p.tableDataSet.getHeaderCollection();d.headRow.html(a.newTableHeader(t,{displayBadge:!0,badgeConfig:{columns:p.tableDataSet.settings.markedColumns,text:"export"}})),b()}(),this.disableDataNavigator(!1)},disableDataNavigator(t){d.fieldSet.prop("disabled",t)},resetFields(){d.form.trigger("reset")}};function h(){let t=d.statusSelectInput.val();t=l.getStatusSymbol(t);const e=function(){const t=[],e=d.evidenceTypeSelectInput.val(),n=d.evidenceTextInput.val().trim(),o=d.observationTextInput.val().trim();n&&(t.push(l.convertToImageFormat(n,e)),o&&t.push("\n"));return t.push(o),t.join("")}();i.addTestResult({resultColumnIdentifier:s.STATUS,result:t,itemIndex:p.currentItem-1}),i.addTestResult({resultColumnIdentifier:s.EVIDENCE,result:e,itemIndex:p.currentItem-1})}function b(){const t=p.tableDataSet.getRowsCollection();d.row.html(a.newTableRow(t[p.currentItem-1]));const{evidenceFilename:e,evidenceObservation:n}=function(){let t,e=i.fetchTestResult({resultColumnIdentifier:s.EVIDENCE,itemIndex:p.currentItem-1}),n="",o=e.indexOf("|thumbnail!");if(r=o,-1!==r){o+=11;const s=e.substring(0,o);n=l.convertFromImageFormat(s),t=e.substring(o).replace("\n","")}else t=e;var r;return{evidenceFilename:n,evidenceObservation:t}}(),o=function(){let t=i.fetchTestResult({resultColumnIdentifier:s.STATUS,itemIndex:p.currentItem-1});return t?function(t){switch(t){case"(/)":return r.SUCCESS;case"(x)":return r.FAILED;case"(!)":return r.ALERT;case"(?)":default:return r.PENDING}}(t):r.PENDING}();d.statusSelectInput.val(o),d.evidenceTextInput.val(e),d.observationTextInput.val(n),function(t,e=p.totalItems){d.counter.html(`${t} / ${e}`)}(p.currentItem)}d=m.components,p=m.settings;var f=m;let g;const w={components:{body:$("#importModalBody"),continueButton:$("#btnImportModalContinue"),warningMessage:$("#warningMessageModal"),theModalItself:$("#importModal")},init(){this.bindUIActions()},bindUIActions(){g.continueButton.click((function(){c.playGlupSound();let t=w.getSelectedCheckBoxes();if(0===t.length)return void I("Selecione pelo menos um dos itens");let e=function(t){let e,n=[];return t.each((t,o)=>{e=parseInt(o.getAttribute("value")),n.push(e)}),n}(t);i.markColumnsForExportation(e);const n=i.exportMarkedColumns(),o=l.convertFromTableDataSet(n);x.setTextAreaContent(o),f.loadTableDataSet(),w.toggle()})),g.theModalItself.on("hide.bs.modal",(function(){g.warningMessage.removeClass("show")}))},setImportOptions(t){if(this.clearOptions(),!t)return void I("Nenhum header encontrado");let e,n=0;t.forEach(t=>{var o;e=a.newCheckBox({label:t,id:"option"+n,value:""+n++,name:"import-options-checkbox"}),o=e,g.body.html(g.body.html()+o)})},clearOptions:function(){g.body.html("")},getSelectedCheckBoxes:function(){return $("input[name='import-options-checkbox']:checked")},toggle(){$("#importModal").modal("toggle")}};function I(t){g.warningMessage.html(t),g.warningMessage.addClass("show")}g=w.components;var v=w;let S;const R={components:{textArea:$("#codeEditor"),importButton:$("#btnImport"),copyButton:$("#btnCopy")},init(){S=this.components,this.bindUIActions()},bindUIActions(){S.importButton.click((function(){c.playGlupSound();const t=S.textArea.val();if(!t)return;const e=l.readTableHeader(t),n=l.readTableRows(t);i.clear(),i.setHeaderCollection(e),i.setRowsCollection(n),i.appendTestResultColumns([s.STATUS,s.EVIDENCE]),v.setImportOptions(i.getHeaderCollection()),v.toggle()})),S.copyButton.click((function(){c.playPoppingSound(),S.textArea.select(),document.execCommand("copy")}))},setTextAreaContent(t){S.textArea.val(t)},clear(){this.components.textArea.val("")}};S=R.components;var x=R;window.onload=()=>{c.init(),v.init(),x.init(),f.init(),$('[data-toggle="tooltip"]').tooltip({delay:{show:800}})}}]);